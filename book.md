# Hi6 로봇제어기 기능설명서 - 엔드리스

{% hint style="warning" %}
본 제품 설명서에서 제공되는 정보는 현대로보틱스의 자산입니다.

현대로보틱스의 서면에 의한 동의 없이 전부 또는 일부를 무단 전재 및 재배포할 수 없으며, 제3자에게 제공되거나 다른 목적에 사용할 수 없습니다.



본 설명서는 사전 예고 없이 변경될 수 있습니다.



**Copyright ⓒ 2020 by Hyundai Robotics**
{% endhint %}
# 1. 개요

본 기능은 로봇의 R1 축 또는 JIG축으로 설정된 부가축에 대해서 소프트리밋을 초과하는 회전이 가능하도록 하는 기능입니다. 이 기능은 크게 세가지 용도로 사용할 수 있습니다. 

첫째는 로봇 JOB 프로그램에서 지정된 스텝의 위치를 기준으로하여 회전수를 지정하는 방법입니다. JOB 프로그램 상단에 회전량을 설정하고 구동하면 그 횟수만큼만 축이 회전하는 JOB 프로그램을 만들 수 있습니다. 

두 번째로 ± 180 deg를 초과한 엔드리스 회전축을 ± 180 deg 이내의 회전각으로 환산하는 기능입니다. 예를 들어 360 deg 회전되어 있는 축은 물리적으로 0 deg와 동일합니다. 이때 엔드리스 리셋 기능은 축을 0 deg 위치로 이동시킬 때 역회전을 시키지 않는 편리한 기능입니다.

마지막으로 엔드리스 회전축을 0 deg로 설정하는 기능입니다. 이 엔드리스 제로 기능은 엔드리스 회전 축의 절대 위치는 상관 없이 현재 위치를 0 deg로 설정하고자 할 때 사용하는 기능입니다. 따라서 엔드리스 리셋 기능과 유사하나 물리적인 축의 절대 위치는 유지하지 않고 현재의 위치를 0으로 변경합니다.


- 기능의 특징 

    (1) 엔드리스 회전수의 간편한 지정(전용함수 지원) <br>
    (2) R1축 엔드리스 회전시 직선 보간지원(단, 툴의 X,Y방향은 내부적으로 0으로 설정됨)<br>
    (3) 소프트리밋을 범위를 벗어나는 범위의 회전이 가능<br>
    (4) 스텝도달시, 정지시의 자동 리셋기능<br>
    (5) 1회전 이내의 각도로 변환하는 엔드리스 리셋 전용 함수 제공<br>

![](../_assets/image_1.png)# 2. 시스템 설정

1.	[**시스템 > 초기화 > 메커니즘 설정**]메뉴에서 엔드리스 축을 설정합니다. 엔드리스 축으로 사용하고자 하는 축을 엔드리스 '유효'로 설정을 변경합니다. 엔드리스 축은 축 사양에 따라 선택이 가능하지 않을 수 있습니다. 

2.	축 사양이 '로봇'인 경우 'R1'축이 엔드리스 축으로 설정이 가능하고, 부가축인 경우 축 사양이 '지그' 또는 '포지셔너'일 때 엔드리스를 유효로 설정할 수 있습니다.

3.	설정이 완료되었으면 완료 키를 누릅니다.

![](../_assets/image_2.png)

4.	제어기를 재부팅하면 엔드리스 축 설정이 적용됩니다.

<br>

{% hint style="info" %} 
1.	본 기능은 제어기를 재부팅할 때 엔드리스 축에 대해서 -180~180deg로 자동 환산하여 축의 위치를 변경합니다.
2.	백업된 프로젝트 파일로 제어기를 복구하고자 할 때에는 엔드리스 축의 물리적인 위치는 복구할 수 없으므로, 엔코더 옵셋 및 축정수 위치를 다시 설정하여 주십시오.

{% endhint %}
# 2.1 환경 설정

1.	[**시스템 > 초기화 > 메커니즘 설정**]메뉴에서 엔드리스 축을 설정합니다. 엔드리스 축으로 사용하고자 하는 축을 엔드리스 '유효'로 설정을 변경합니다. 엔드리스 축은 축 사양에 따라 선택이 가능하지 않을 수 있습니다. 

2.	축 사양이 '로봇'인 경우 'R1'축이 엔드리스 축으로 설정이 가능하고, 부가축인 경우 축 사양이 '지그' 또는 '포지셔너'일 때 엔드리스를 유효로 설정할 수 있습니다.

3.	설정이 완료되었으면 완료 키를 누릅니다.
![](../_assets/image_2.png)

4.	제어기를 재부팅하면 엔드리스 축 설정이 적용됩니다.

<br>

{% hint style="info" %} 
1.	본 기능은 제어기를 재부팅할 때 엔드리스 축에 대해서 -180~180deg로 자동 환산하여 축의 위치를 변경합니다.
2.	백업된 프로젝트 파일로 제어기를 복구하고자 할 때에는 엔드리스 축의 물리적인 위치는 복구할 수 없으므로, 엔코더 옵셋 및 축정수 위치를 다시 설정하여 주십시오.

{% endhint %}
# 3. 엔드리스 기능

# 3.1 endless 명령어

### 설명
- 다음 스텝으로 이동하면서 엔드리스로 설정된 축을 지정한 회전수만큼 회전시킬 수 있습니다.
- 엔드리스 축의 물리적인 위치를 보전하면서 -180~180deg 이내의 각도로 환산할 수 있습니다.
- 엔드리스 축의 물리적인 위치를 무시하고 현재의 위치를 0deg 또는 지정한 각도로 설정할 수 있습니다.

### 문법

```python
endless turn,axis=<축 번호>,count=<회전 수>
endless change,axis=<축 번호>,value=<축 각도>
endless reset
endless zero
```

### 파라미터
<table>
<thead>
    <tr>
    <th style="text-align:left">항목</th>
    <th style="text-align:left">의미</th>
    <th style="text-align:left">기타</th>
    </tr>
</thead>
<tbody>
    <tr>
    <td style="text-align:left">동작</td>
    <td style="text-align:left">
        - turn: 다음 스텝으로 이동할 때 엔드리스 축을 지정한 회전 수만큼 회전<br>
        - change: 엔드리스 축의 현재 위치를 지정한 축 각도로 설정<br>
        - reset: 엔드리스 축의 현재 위치를 -180~180deg이내의 각도로 환산<br>
        - zero: 엔드리스 축의 현재 위치를 0deg로 설정
    </td>
    <td style="text-align:left">문자열</td>
    </tr>
</tbody>
<tbody>
    <tr>
    <td style="text-align:left">축 번호</td>
    <td style="text-align:left">
        엔드리스 기능을 사용할 축 번호
    </td>
    <td style="text-align:left">변수</td>
    </tr>
</tbody>
<tbody>
    <tr>
    <td style="text-align:left">회전 수</td>
    <td style="text-align:left">
        엔드리스 축을 회전할 회전 수
    </td>
    <td style="text-align:left">변수(-10000~10000)</td>
    </tr>
</tbody>
    <tbody>
    <tr>
    <td style="text-align:left">축 각도</td>
    <td style="text-align:left">
        엔드리스 축의 현재 위치로 설정할 축 각도
    </td>
    <td style="text-align:left">변수</td>
    </tr>
</tbody>
</table>

{% hint style="info" %} 

회전 수는 해당 축이름의 1회에 회전할 회전수를 설정합니다. (-10000~10000회전)
회전수는 축의 감속비에 따라 설정가능한 범위가 달라집니다. 통상적으로 R1축의 경우 1000회전 설정은 문제가 없습니다. 그러나 그 이상으로 설정하는 경우 프로그램을 기동할 때 endless 명령에서 'E0173 엔드리스 회전량의 오버플로우' 에러가 발생할 수 있습니다. 이 경우 1회에 회전할 수 있는 회전량의 범위를 벗어난 것이므로 줄여서 설정해야 합니다.

{% endhint %}



### 사용 예
```python
S1  move P,spd=100%,accu=1,tool=1 
S2  move P,spd=30%,accu=5,tool=1  
    endless turn,axis=6,count=10        # 6축을 10회전 지정
S3  move L,spd=30%,accu=1,tool=1        # S3로 이동할 때 6축을 10회전하면서 이동
    endless change,axis=6,value=750     # 6축을 750deg로 설정
S4  move L,spd=30%,accu=1,tool=1  
    endless reset                       # 모든 엔드리스 축을  -180~180deg 이내의 각도로 환산
S5  move L,spd=30%,accu=1,tool=1  
    endless zero                        # 모든 엔드리스 축을 0deg로 설정
S6  move L,spd=30%,accu=1,tool=1  
    end
```# 3.2 R코드

엔드리스 기능에서 지원하는 R코드 기능입니다. R코드의 기본적인 사용 방법은 하기 링크를 참고하십시오.

[R코드 기본 사용법](https://hrbook-hrc.web.app/#/view/doc-hi6-operation/korean-tp630/8-r-code/1-use-r-code)# 3.2.1 R350 엔드리스축 수동 리셋
R350 코드에 의한 수동 리셋 기능은 로봇이 정지하고 있을 때 프로그램 명령(endless reset)을 대신하여 사용자가 수동 혹은 자동모드에서 리셋하고자 할 때 사용합니다.

|         **R코드**     |         **파라미터**  |        **설명**       |
| :-------------------: | :-------------------: | :-------------------: |
| R350                  |        0              | 모든 축에 대한 리셋    |
| R350                  |   엔드리스 축 번호     | 지정한 축에 대한 리셋  |# 3.2.2 R354 엔드리스 Zero 실행
R350 코드에 의한 수동 제로 기능은 로봇이 정지하고 있을 때 프로그램 명령(endless zero)을 대신하여 수동 혹은 자동모드에서 사용자가 축 위치를 0deg로 설정하고자 할 때 사용합니다.

|         **R코드**     |         **파라미터**  |        **설명**       |
| :-------------------: | :-------------------: | :-------------------: |
| R354                  |        0              | 모든 축에 대한 Zero    |
| R354                  |   엔드리스 축 번호     | 지정한 축에 대한 Zero  |# 3.3 에러 코드


| **에러번호** |    **에러 메시지**  |    **설명**  |
| :------: | :------------------------: |  :------------------------: | 
|   E0108   | (0축)엔코더이상:엔코더 리셋 필요   | 엔코더가 사용할 수 없는 범위에 있습니다 엔코더 옵셋 보정을 다시 하여 사용하십시오.|
|   E0172   | (0축) 엔드리스 회전위치 이상   | 초기화시에 발생하는 에러로 백업되어 있는 현재 엔코더의 위치와 전원을 켜고 절대치 엔코더 값을 읽었을 때의 차이가 0x20000이상인 경우에 에러가 발생하게 됩니다. <br>이 에러가 발생하면 해당축의 엔코더 옵셋 보정을 다시 해야 합니다.|
|   E0173   | 엔드리스 회전량의 오버플로우   | 소프트웨어로 처리할 수 있는 유효숫자를 초과하는 회전량을 지정하였습니다. 감속비가 큰 경우에는 1000회전 미만의 회전량이라 할지라도 한번에 회전이 불가능할 수 있습니다. endless 명령에 지정한 회전수를 낮추어 사용하십시오.| 
|   E0193   | (0축)엔드리스 지원않는 엔코더타입  | 모터 1회전당 1024, 2048, 4096, 8192 펄스인 엔코더만 엔드리스 기능을 지원하도록 소프트웨어 처리가 되어 있습니다. 그 외의 엔코더는 지원하지 않습니다.| 